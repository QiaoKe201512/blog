### 监控数据采集方法论<Badge type="tip" text="工程化" />

如何监控不同的目标对象，如何设计采集指标？

#### Google 的四个黄金指标

| 指标名称   | 定义                                                         | 例子                                                         |
| ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **延迟**   | 请求被处理所需的时间，包括成功和失败的请求。                 | 请求到数据库的查询时间是150毫秒；用户点击按钮后，页面加载时间为2秒。 |
| **流量**   | 系统处理的请求数量或处理的工作负载，通常以每秒请求数或数据传输量为单位。 | API 每秒接收1000个请求；每小时上传1GB的数据到云存储。        |
| **错误率** | 请求失败的比例，通常表示为百分比或失败请求的数量。           | 每1000个请求中有5个返回了500内部服务器错误；0.1%的请求因超时失败。 |
| **饱和度** | 系统资源的利用率，通常指接近或达到资源极限的程度。           | CPU 使用率接近90%，内存占用达到95%。                         |

#### USE 方法

USE 方法（Utilization, Saturation, Errors）是一种专注于监控系统资源健康状况的有效方式，主要用于硬件和基础设施的性能监控。


| 指标名称       | 定义                                                         | 例子                                                               |
| -------------- | ------------------------------------------------------------ | ------------------------------------------------------------------ |
| **利用率**     | 资源的实际使用率，即一个资源在单位时间内被使用的百分比。     | CPU 利用率为85%；网络带宽利用率为50%。                             |
| **饱和度**     | 资源超出负载能力的程度，或资源请求等待的情况。               | 磁盘I/O队列中有大量请求排队；CPU 正在处理多个请求，导致部分等待。   |
| **错误率**     | 资源处理请求时发生的错误数量，包括硬件或软件故障。           | 网络接口每小时出现10个数据包丢失；内存模块发生3次ECC错误。         |

#### 监控分类角度

不同的监控对象有不同的侧重点。

![image-20241012201105578](/image-20241012201105578.png)

##### 业务监控

对业务运行有影响的一些指标，管理层比较关注，精确度要求不高，实时性要求高。BI数据相关。

##### 应用监控

应用监控就是针对APP的监控，谷歌的四个黄金指标就是针对此监控设计的。APM，链路追踪，javaagent等技术。

##### 组件监控

组件主要指数据库，中间件，云平台等。

##### 资源监控

基础资源的监控，主要是针对设备和网络，设备又分为服务器、网络设备，网络监控又分为连 通性监控、质量监控、流量监控。

##### 设备监控

服务器CPU 内存等；网络设备交换机，防火墙，通过SNMP获取指标或者syslog的方式把日志转存出来。

##### 网络监控

网络连通性，ICMP协议的ping还可以探测丢包率和延迟。流量监控，网卡流量，交换机流量，机房出口流量等。
